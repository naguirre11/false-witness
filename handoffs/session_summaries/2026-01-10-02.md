---
session_date: 2026-01-10T02:00:00Z
tickets_worked: [FW-042d]
status: completed
---

## Summary

Implemented FW-042d (Entity-specific hunt variations) - the framework of virtual methods that allows entity subclasses to customize hunt behavior including sanity thresholds, speed variations, duration, cooldowns, and special conditions.

## Changes Made

### Modified Files
- `src/entity/entity.gd`:
  - Added "Hunt Variation Virtual Methods" section with 8 new virtual methods
  - `get_hunt_sanity_threshold()` - entity-specific sanity thresholds
  - `should_ignore_team_sanity()` - for Banshee-style targeting
  - `can_voice_trigger_hunt()` - for Listener voice-triggered hunts
  - `get_hunt_speed_for_awareness(aware: bool)` - speed based on target awareness
  - `_update_hunt_speed(delta: float)` - dynamic speed updates (Revenant acceleration)
  - `can_hunt_in_current_conditions()` - environmental hunt conditions (Mare lighting)
  - `get_hunt_duration()` - entity-specific hunt durations
  - `get_hunt_cooldown()` - entity-specific cooldowns (Demon 20s vs 25s)
  - Wired `get_current_speed()` to use `get_hunt_speed_for_awareness()`
  - Wired `on_hunt_started()` to use `get_hunt_duration()`
  - Added `_update_hunt_speed(delta)` call in `_process_hunting()`

- `tests/test_entity.gd`:
  - Added 22 new tests for hunt variation virtual methods
  - Added `CustomEntity` test class demonstrating subclass override patterns
  - Total entity tests: 73

### Workflow Files
- `COMMANDS.md`: Clarified `%flowchart` path reference to `./FLOWCHART.md (project root)`

## Current State

- All 73 entity tests pass
- Full test suite passes
- Lint passes
- FW-042d moved to for_review
- Parent epic FW-042 moved to for_review (all sub-tickets complete)
- NEXT updated to FW-043-death-respawn

## Next Steps

1. FW-043: Echo system (dead players) - what happens when players die during hunts
2. FW-044: First entity implementation (Phantom) - will use the variation framework
3. FW-046: Listener entity - will override `can_voice_trigger_hunt()`

## Architecture Notes

### How Entity Subclasses Use Variations

```gdscript
# Example: Demon entity (hunts early/often)
class_name DemonEntity
extends Entity

func get_hunt_sanity_threshold() -> float:
    return 70.0  # Hunts at 70% sanity (vs 50% standard)

func get_hunt_cooldown() -> float:
    return 20.0  # 20s cooldown (vs 25s standard)
```

```gdscript
# Example: Revenant (accelerates during chase)
class_name RevenantEntity
extends Entity

var _current_hunt_speed: float = 1.0

func get_hunt_speed_for_awareness(aware: bool) -> float:
    return _current_hunt_speed

func _update_hunt_speed(delta: float) -> void:
    if _is_aware_of_target:
        _current_hunt_speed = minf(_current_hunt_speed + delta * 0.5, 3.0)
    else:
        _current_hunt_speed = maxf(_current_hunt_speed - delta * 1.0, 1.0)
```

## Open Questions

None - framework is complete. Actual entity implementations will come in FW-044+.
